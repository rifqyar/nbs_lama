/*
 * jScrollPane - v2.0.0beta10 - 2011-04-17
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
 
(function(b,Ea,r){b.fn.jScrollPane=function(z){function ea(c,z){function L(a){var d,s,h,n,o,q=!1,k=!1;e=a;if(f===r)n=c.scrollTop(),o=c.scrollLeft(),c.css({overflow:"hidden",padding:0}),j=c.innerWidth()+M,i=c.innerHeight(),c.width(j),f=b('<div class="jspPane" />').css("padding",ka).append(c.children()),g=b('<div class="jspContainer" />').css({width:j+"px",height:i+"px"}).append(f).appendTo(c);else{c.css("width","");q=e.stickToBottom&&ta();k=e.stickToRight&&ua();if(h=c.innerWidth()+M!=j||c.outerHeight()!=
i)j=c.innerWidth()+M,i=c.innerHeight(),g.css({width:j+"px",height:i+"px"});if(!h&&la==t&&f.outerHeight()==p){c.width(j);return}la=t;f.css("width","");c.width(j);b.isFunction(b.fn.axZmRemove)?g.find(">.jspVerticalBar,>.jspHorizontalBar").axZmRemove(!0).end():g.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}f.css("overflow","auto");t=a.contentWidth?a.contentWidth:f[0].scrollWidth;p=f[0].scrollHeight;f.css("overflow","");fa=t/j;W=p/i;x=1<W;w=1<fa;if(!w&&!x)c.removeClass("jspScrollable"),
f.css({top:0,width:g.width()-M}),g.unbind(ga),f.find(":input,a").unbind("focus.jsp"),c.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),ma(),na();else{c.addClass("jspScrollable");if(a=e.maintainPosition&&(l||m))d=D(),s=E();ea();va();wa();a&&(O(k?t-j:d,!1),F(q?p-i:s,!1));xa();ya();za();e.enableKeyboardNavigation&&Aa();e.clickOnTrack&&Ba();Ca();e.hijackInternalLinks&&oa()}e.autoReinitialise&&!X?X=setInterval(function(){L(e)},e.autoReinitialiseDelay):!e.autoReinitialise&&
X&&clearInterval(X);n&&c.scrollTop(0)&&F(n,!1);o&&c.scrollLeft(0)&&O(o,!1);c.trigger("jsp-initialised",[w||x])}function ea(){x&&(g.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />'))),Y=g.find(">.jspVerticalBar"),A=Y.find(">.jspTrack"),u=A.find(">.jspDrag"),e.showArrows&&(R=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",
G(0,-1)).bind("click.jsp",P),S=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",G(0,1)).bind("click.jsp",P),e.arrowScrollOnHover&&(R.bind("mouseover.jsp",G(0,-1,R)),S.bind("mouseover.jsp",G(0,1,S))),pa(A,e.verticalArrowPositions,R,S)),H=i,g.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){H-=b(this).outerHeight()}),u.hover(function(){u.addClass("jspHover")},function(){u.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",
P);u.addClass("jspActive");var d=a.pageY-u.position().top;b("html").bind("mousemove.jsp",function(a){N(a.pageY-d,!1)}).bind("mouseup.jsp mouseleave.jsp",qa);return!1}),ra())}function ra(){A.height(H+"px");l=0;ha=e.verticalGutter+A.outerWidth();f.width(j-ha-M);try{0===Y.position().left&&f.css("margin-left",ha+"px")}catch(a){}}function va(){w&&(g.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),
b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />'))),Z=g.find(">.jspHorizontalBar"),B=Z.find(">.jspTrack"),v=B.find(">.jspDrag"),e.showArrows&&(T=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",G(-1,0)).bind("click.jsp",P),U=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",G(1,0)).bind("click.jsp",P),e.arrowScrollOnHover&&(T.bind("mouseover.jsp",G(-1,0,T)),U.bind("mouseover.jsp",G(1,0,U))),pa(B,e.horizontalArrowPositions,T,U)),v.hover(function(){v.addClass("jspHover")},
function(){v.removeClass("jspHover")}).bind("mousedown.jsp",function(a){b("html").bind("dragstart.jsp selectstart.jsp",P);v.addClass("jspActive");var d=a.pageX-v.position().left;b("html").bind("mousemove.jsp",function(a){Q(a.pageX-d,!1)}).bind("mouseup.jsp mouseleave.jsp",qa);return!1}),y=g.innerWidth(),sa())}function sa(){g.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){y-=b(this).outerWidth()});B.width(y+"px");m=0}function wa(){if(w&&x){var a=B.outerHeight(),
d=A.outerWidth();H-=a;b(Z).find(">.jspCap:visible,>.jspArrow").each(function(){y+=b(this).outerWidth()});y-=d;i-=d;j-=a;B.parent().append(b('<div class="jspCorner" />').css("width",a+"px"));ra();sa()}w&&f.width(g.outerWidth()-M+"px");p=f.outerHeight();W=p/i;w&&(I=Math.ceil(1/fa*y),I>e.horizontalDragMaxWidth?I=e.horizontalDragMaxWidth:I<e.horizontalDragMinWidth&&(I=e.horizontalDragMinWidth),v.width(I+"px"),J=y-I,ia(m));x&&(K=Math.ceil(1/W*H),K>e.verticalDragMaxHeight?K=e.verticalDragMaxHeight:K<e.verticalDragMinHeight&&
(K=e.verticalDragMinHeight),u.height(K+"px"),C=H-K,ja(l))}function pa(a,d,b,e){var c="before",o="after";"os"==d&&(d=/Mac/.test(navigator.platform)?"after":"split");d==c?o=d:d==o&&(c=d,d=b,b=e,e=d);a[c](b)[o](e)}function G(a,d,b){return function(){Da(a,d,this,b);this.blur();return!1}}function Da(a,d,c,h){var c=b(c).addClass("jspActive"),n,o,q=!0,f=function(){0!==a&&k.scrollByX(a*e.arrowButtonSpeed);0!==d&&k.scrollByY(d*e.arrowButtonSpeed);o=setTimeout(f,q?e.initialDelay:e.arrowRepeatFreq);q=!1};f();
n=h?"mouseout.jsp":"mouseup.jsp";h=h||b("html");h.bind(n,function(){c.removeClass("jspActive");o&&clearTimeout(o);o=null;h.unbind(n)})}function Ba(){ma();x&&A.bind("mousedown.jsp",function(a){if(a.originalTarget===r||a.originalTarget==a.currentTarget){var d=b(this),c=d.offset(),h=a.pageY-c.top-l,n,o=!0,q=function(){var b=d.offset(),b=a.pageY-b.top-K/2,c=i*e.scrollPagePercent,s=C*c/(p-i);if(0>h)l-s>b?k.scrollByY(-c):N(b);else if(0<h)l+s<b?k.scrollByY(c):N(b);else{f();return}n=setTimeout(q,o?e.initialDelay:
e.trackClickRepeatFreq);o=!1},f=function(){n&&clearTimeout(n);n=null;b(document).unbind("mouseup.jsp",f)};q();b(document).bind("mouseup.jsp",f);return!1}});w&&B.bind("mousedown.jsp",function(a){if(a.originalTarget===r||a.originalTarget==a.currentTarget){var d=b(this),c=d.offset(),h=a.pageX-c.left-m,n,o=!0,f=function(){var b=d.offset(),b=a.pageX-b.left-I/2,c=j*e.scrollPagePercent,s=J*c/(t-j);if(0>h)m-s>b?k.scrollByX(-c):Q(b);else if(0<h)m+s<b?k.scrollByX(c):Q(b);else{g();return}n=setTimeout(f,o?e.initialDelay:
e.trackClickRepeatFreq);o=!1},g=function(){n&&clearTimeout(n);n=null;b(document).unbind("mouseup.jsp",g)};f();b(document).bind("mouseup.jsp",g);return!1}})}function ma(){B&&B.unbind("mousedown.jsp");A&&A.unbind("mousedown.jsp")}function qa(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");u&&u.removeClass("jspActive");v&&v.removeClass("jspActive")}function N(a,d){x&&(0>a?a=0:a>C&&(a=C),d===r&&(d=e.animateScroll),d?k.animate(u,"top",a,ja):(u.css("top",a),
ja(a)))}function ja(a){a===r&&(a=u.position().top);g.scrollTop(0);l=a;var d=0===l,b=l==C,a=-(a/C)*(p-i);if($!=d||aa!=b)$=d,aa=b,c.trigger("jsp-arrow-change",[$,aa,ba,ca]);e.showArrows&&(R[d?"addClass":"removeClass"]("jspDisabled"),S[b?"addClass":"removeClass"]("jspDisabled"));f.css("top",a);c.trigger("jsp-scroll-y",[-a,d,b]).trigger("scroll")}function Q(a,d){w&&(0>a?a=0:a>J&&(a=J),d===r&&(d=e.animateScroll),d?k.animate(v,"left",a,ia):(v.css("left",a),ia(a)))}function ia(a){a===r&&(a=v.position().left);
g.scrollTop(0);m=a;var d=0===m,b=m==J,a=-(a/J)*(t-j);if(ba!=d||ca!=b)ba=d,ca=b,c.trigger("jsp-arrow-change",[$,aa,ba,ca]);e.showArrows&&(T[d?"addClass":"removeClass"]("jspDisabled"),U[b?"addClass":"removeClass"]("jspDisabled"));f.css("left",a);c.trigger("jsp-scroll-x",[-a,d,b]).trigger("scroll")}function F(a,d){N(a/(p-i)*C,d)}function O(a,d){Q(a/(t-j)*J,d)}function V(a,d,c){var h,n,f=0,q=0,k,l,m;try{h=b(a)}catch(p){return}n=h.outerHeight();a=h.outerWidth();g.scrollTop(0);for(g.scrollLeft(0);!h.is(".jspPane");)if(f+=
h.position().top,q+=h.position().left,h=h.offsetParent(),/^body|html$/i.test(h[0].nodeName))return;h=E();k=h+i;f<h||d?l=f-e.verticalGutter:f+n>k&&(l=f-i+n+e.verticalGutter);l&&F(l,c);f=D();l=f+j;q<f||d?m=q-e.horizontalGutter:q+a>l&&(m=q-j+a+e.horizontalGutter);m&&O(m,c)}function D(){return-f.position().left}function E(){return-f.position().top}function ta(){var a=p-i;return 20<a&&10>a-E()}function ua(){var a=t-j;return 20<a&&10>a-D()}function ya(){g.unbind(ga).bind(ga,function(a,d,b,c){a=m;d=l;k.scrollBy(b*
e.mouseWheelSpeed,-c*e.mouseWheelSpeed,!1);return a==m&&d==l})}function P(){return!1}function xa(){f.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){V(a.target,!1)})}function Aa(){function a(){var a=m,b=l;switch(d){case 40:k.scrollByY(e.keyboardSpeed,!1);break;case 38:k.scrollByY(-e.keyboardSpeed,!1);break;case 34:case 32:k.scrollByY(i*e.scrollPagePercent,!1);break;case 33:k.scrollByY(-i*e.scrollPagePercent,!1);break;case 39:k.scrollByX(e.keyboardSpeed,!1);break;case 37:k.scrollByX(-e.keyboardSpeed,
!1)}return s=a!=m||b!=l}var d,s,h=[];w&&h.push(Z[0]);x&&h.push(Y[0]);f.focus(function(){c.focus()});c.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(c){if(!(c.target!==this&&(!h.length||!b(c.target).closest(h).length))){var e=m,f=l;switch(c.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:d=c.keyCode;a();break;case 35:F(p-i);d=null;break;case 36:F(0),d=null}s=c.keyCode==d&&e!=m||f!=l;return!s}}).bind("keypress.jsp",function(b){b.keyCode==d&&a();return!s});
e.hideFocus?(c.css("outline","none"),"hideFocus"in g[0]&&c.attr("hideFocus",!0)):(c.css("outline",""),"hideFocus"in g[0]&&c.attr("hideFocus",!1))}function Ca(){if(location.hash&&1<location.hash.length){var a,d;try{a=b(location.hash)}catch(c){return}a.length&&f.find(location.hash)&&(0===g.scrollTop()?d=setInterval(function(){0<g.scrollTop()&&(V(location.hash,!0),b(document).scrollTop(g.position().top),clearInterval(d))},50):(V(location.hash,!0),b(document).scrollTop(g.position().top)))}}function na(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}
function oa(){na();b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var a=this.href.split("#");if(1<a.length&&(a=a[1],0<a.length&&0<f.find("#"+a).length))return V("#"+a,!0),!1})}function za(){var a,b,c,e,f,i=!1;g.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){g=g.originalEvent.touches[0];a=D();b=E();c=g.pageX;e=g.pageY;f=!1;i=!0}).bind("touchmove.jsp",function(g){if(i){var g=g.originalEvent.touches[0],j=m,p=l;k.scrollTo(a+
c-g.pageX,b+e-g.pageY);f=f||5<Math.abs(c-g.pageX)||5<Math.abs(e-g.pageY);return j==m&&p==l}}).bind("touchend.jsp",function(){i=!1}).bind("click.jsp-touchclick",function(){if(f)return f=!1})}var e,k=this,f,j,i,g,t,p,fa,W,x,w,u,C,l,v,J,m,Y,A,ha,H,K,R,S,Z,B,y,I,T,U,X,ka,M,la,$=!0,ba=!0,aa=!1,ca=!1,da=b.isFunction(b.fn.axZmEmpty)?c.clone(!1,!1).axZmEmpty(!0):c.clone(!1,!1).empty(),ga=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";ka=c.css("paddingTop")+" "+c.css("paddingRight")+" "+c.css("paddingBottom")+
" "+c.css("paddingLeft");M=(parseInt(c.css("paddingLeft"),10)||0)+(parseInt(c.css("paddingRight"),10)||0);b.extend(k,{reinitialise:function(a){a=b.extend({},e,a);L(a)},scrollToElement:function(a,b,c){V(a,b,c)},scrollTo:function(a,b,c){O(a,c);F(b,c)},scrollToX:function(a,b){O(a,b)},scrollToY:function(a,b){F(a,b)},scrollToPercentX:function(a,b){O(a*(t-j),b)},scrollToPercentY:function(a,b){F(a*(p-i),b)},scrollBy:function(a,b,c){k.scrollByX(a,c);k.scrollByY(b,c)},scrollByX:function(a,b){var c=(D()+a)/
(t-j);Q(c*J,b)},scrollByY:function(a,b){var c=(E()+a)/(p-i);N(c*C,b)},positionDragX:function(a,b){Q(a,b)},positionDragY:function(a,b){N(a,b)},animate:function(a,b,c,f){var g={};g[b]=c;a.animate(g,{duration:e.animateDuration,ease:e.animateEase,queue:!1,step:f})},getContentPositionX:function(){return D()},getContentPositionY:function(){return E()},getContentWidth:function(){return t},getContentHeight:function(){return p},getPercentScrolledX:function(){return D()/(t-j)},getPercentScrolledY:function(){return E()/
(p-i)},getIsScrollableH:function(){return w},getIsScrollableV:function(){return x},getContentPane:function(){return f},scrollToBottom:function(a){N(C,a)},hijackInternalLinks:function(){oa()},destroy:function(){var a=E(),d=D();c.removeClass("jspScrollable").unbind(".jsp");if(b.isFunction(b.fn.axZmEmpty)){var e=da.append(f.children());c.axZmEmpty(!0).css("background-image","none").replaceWith(e)}else c.replaceWith(da.append(f.children()));da.scrollTop(a);da.scrollLeft(d)}});L(z)}z=b.extend({},b.fn.jScrollPane.defaults,
z);b.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){z[this]=z[this]||z.speed});var L;this.each(function(){var c=b(this),r=c.data("jsp");r?r.reinitialise(z):(r=new ea(c,z),c.data("jsp",r));L=L?L.add(c):c});return L};b.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,
contentWidth:r,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);